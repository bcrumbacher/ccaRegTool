{"ast":null,"code":"import _ from \"lodash\";\nimport { EVENT_CONST } from \"./feeVals\";\nimport calcFee from \"./calcFee\";\nimport speechAndDebate from \"./speechAndDebate\";\nexport default async function parseFile(file, isSeperate) {\n  const fileReader = new FileReader();\n  fileReader.readAsText(file, \"UTF-8\");\n  var res;\n  let jsonData;\n  await new Promise(resolve => fileReader.onload = () => resolve());\n  jsonData = JSON.parse(fileReader.result);\n  console.log(jsonData);\n  let clubs = jsonData.schools.map(function (club) {\n    const uniqueFamilies = _.groupBy(club.students, student => student.last);\n    const families = Object.entries(uniqueFamilies).map(famArray => {\n      return {\n        name: famArray[0],\n        students: famArray[1]\n      };\n    });\n    return {\n      name: club.name,\n      families: families,\n      entries: club.entries,\n      id: club.id\n    };\n  });\n  console.log(clubs);\n  let catMap = [];\n  jsonData.categories.forEach(cat => {\n    cat.events.forEach(event => {\n      let type;\n      const name = event.name.toLowerCase().trim();\n      if (event.type.toLowerCase().trim() === \"debate\") {\n        type = EVENT_CONST.DEBATE;\n      } else if (name.startsWith(\"jv\")) {\n        type = EVENT_CONST.JV;\n      } else if (name.startsWith(\"jr\")) {\n        type = EVENT_CONST.JR;\n      } else {\n        type = EVENT_CONST.VARSITY;\n      }\n      catMap.push({\n        id: event.id,\n        type: type\n      });\n    });\n  });\n  clubs = clubs.map(club => {\n    let judges = [];\n    jsonData.categories.forEach(judgeCat => {\n      console.log(club);\n      const temp = judgeCat.judges.filter(judge => {\n        return judge.school === club.id;\n      });\n      judges = judges.concat(temp);\n    });\n    console.log(judges);\n    const c = club.families.map(family => {\n      let familyFee = 0;\n      let familyStudents = family.students.length;\n      let seperate = false;\n      const f = family.students.map(student => {\n        const entries = club.entries.filter(entry => entry.students.includes(student.id) && entry.active === 1);\n        const events = entries.map(ent => {\n          const fromEventList = catMap.find(cat => cat.id === ent.event);\n          return fromEventList;\n        });\n        if (familyStudents === 1 && isSeperate) {\n          seperate = speechAndDebate(events);\n        }\n        let fee = calcFee(events);\n        familyFee += fee;\n        return {\n          ...student,\n          events: events,\n          fee: fee,\n          sepearte: seperate\n        };\n      });\n      let judgeReq = 0;\n      const famJudges = judges.filter(judge => {\n        return judge.last === family.name;\n      });\n      console.log(famJudges);\n      if (familyStudents === 1) {\n        judgeReq = seperate ? 2 : 1;\n      } else if (familyStudents > 1) {\n        judgeReq = 2;\n      }\n      return {\n        ...family,\n        students: f,\n        fee: familyFee,\n        judgeReq: judgeReq\n      };\n    });\n    const familyFilter = c.filter(family => family.fee > 0);\n    return {\n      ...club,\n      families: familyFilter\n    };\n  });\n  res = clubs;\n  return res;\n}","map":{"version":3,"names":["_","EVENT_CONST","calcFee","speechAndDebate","parseFile","file","isSeperate","fileReader","FileReader","readAsText","res","jsonData","Promise","resolve","onload","JSON","parse","result","console","log","clubs","schools","map","club","uniqueFamilies","groupBy","students","student","last","families","Object","entries","famArray","name","id","catMap","categories","forEach","cat","events","event","type","toLowerCase","trim","DEBATE","startsWith","JV","JR","VARSITY","push","judges","judgeCat","temp","filter","judge","school","concat","c","family","familyFee","familyStudents","length","seperate","f","entry","includes","active","ent","fromEventList","find","fee","sepearte","judgeReq","famJudges","familyFilter"],"sources":["/Users/bcrumbac/cs_stuff/fees_cca/fees/src/components/parseTournFile.tsx"],"sourcesContent":["import _ from \"lodash\";\nimport { EVENT_CONST } from \"./feeVals\";\nimport calcFee from \"./calcFee\";\nimport speechAndDebate from \"./speechAndDebate\";\nexport default async function parseFile(file: any, isSeperate: boolean) {\n  const fileReader: any = new FileReader();\n  fileReader.readAsText(file, \"UTF-8\");\n  var res;\n  let jsonData: any;\n  await new Promise<void>((resolve) => (fileReader.onload = () => resolve()));\n  jsonData = JSON.parse(fileReader.result);\n  console.log(jsonData);\n  let clubs = jsonData.schools.map(function (club: any) {\n    const uniqueFamilies = _.groupBy(club.students, (student: any) => student.last);\n    const families = Object.entries(uniqueFamilies).map((famArray: any) => {\n      return {\n        name: famArray[0],\n        students: famArray[1],\n      };\n    });\n\n    return {\n      name: club.name,\n      families: families,\n      entries: club.entries,\n      id: club.id,\n    };\n  });\n  console.log(clubs);\n  let catMap: any[] = [];\n  jsonData.categories.forEach((cat: any) => {\n    cat.events.forEach((event: any) => {\n      let type: any;\n      const name = event.name.toLowerCase().trim();\n      if (event.type.toLowerCase().trim() === \"debate\") {\n        type = EVENT_CONST.DEBATE;\n      } else if (name.startsWith(\"jv\")) {\n        type = EVENT_CONST.JV;\n      } else if (name.startsWith(\"jr\")) {\n        type = EVENT_CONST.JR;\n      } else {\n        type = EVENT_CONST.VARSITY;\n      }\n      catMap.push({ id: event.id, type: type });\n  })\n  });\n\n  clubs = clubs.map((club: any) => {\n    let judges: any[] = [];\n    jsonData.categories.forEach((judgeCat: any) => {\n      console.log(club);\n      const temp = judgeCat.judges.filter((judge: any) => {\n          return judge.school === club.id\n      });\n    judges = judges.concat(temp);\n    }\n    )\n    console.log(judges);\n    const c = club.families.map((family: any) => {\n      let familyFee = 0;\n      let familyStudents = family.students.length;\n      let seperate = false;\n      const f = family.students.map((student: any) => {\n        const entries = club.entries.filter(\n          (entry: any) => entry.students.includes(student.id) && entry.active === 1\n        );\n        const events = entries.map((ent: any) => {\n          const fromEventList = catMap.find((cat: any) => cat.id === ent.event);\n          return fromEventList;\n        });\n        if (familyStudents === 1 && isSeperate) {\n          seperate = speechAndDebate(events);\n        }\n        let fee = calcFee(events);\n        familyFee += fee;\n        return {\n          ...student,\n          events: events,\n          fee: fee,\n          sepearte: seperate,\n        };\n      });\n      let judgeReq = 0;\n      const famJudges = judges.filter((judge: any) => {\n        return judge.last === family.name;\n      });\n      console.log(famJudges);\n      if (familyStudents === 1) {\n        judgeReq = seperate ? 2 : 1;\n      } else if (familyStudents > 1) {\n        judgeReq = 2;\n      }\n\n      return  { ...family, students: f, fee: familyFee, judgeReq: judgeReq };\n    });\n    const familyFilter = c.filter((family: any) => family.fee > 0);\n    return {\n      ...club,\n      families: familyFilter,\n    };\n  });\n  res = clubs;\n\n  return res;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}